<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-cn" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.115.1">
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Spring Cloud | x-windy</title>
<meta name="description" content="Spring Cloud常用组件 服务的注册和发现。(eureka-netflix,nacos-spring官方,consul-alibaba) 服务的负载均衡。(ribbon,dubbo)
服务的相互调用。(openfegin,dubbo)
服务的容错。 (hystrix，sentinel)
服务网关。 (gateway，zuul)
服务配置的统一管理。(config-server,nacos,apollo)
服务消息总线。(bus)
服务安全组件。(security,Oauth2.0)
服务监控。(admin) (jvm)
链路追踪。(sleuth&#43;zipkin)
SpringCloud spring官方 netflix alibaba 其它 注册中心 consul eureka nacos apache/zookeeper 负载均衡 ribbon dubbo GRPC 远程调用 openFeign(集成ribbon) dubbo 熔断器 hystrix sentinel 网关 gateway zuul &amp;mdash;&amp;mdash;&amp;mdash;- 配置文件中心 configServer nacos 携程/Apollo 监控组件 admin dubbo-admin 分布式事务 seata LCN/TCC/MQ 消息队列 stream rocketMq rabbitmq/kafka/activemq 微服务 不是一个框架，而是一构建思想。
它时用来描述将如那件应用程序设计为独立部署的服务的一种特殊方式。
微服务构架的系统是个 分布式系统，按业务领域划分为 独立的服务单元，有自动化运维、容错、快速演进的特点，它能够解决传统单体架构系统的痛点，同时也能满足越来越复杂的业务需求
什么是微服务？ 就是将一个大的应用，拆分成多个小的模块，每个模块都有自己的功能和职责，每个模块可以进行交互，这就是微服务
“微服务”的发明人，Martin Fowler的理解：
简而言之，微服务架构的风格，就是将单一程序开发成一个微服务每个微服务运行在自己的进程中，并使用 轻量级机制通信 ，通常是HTTP RESTFUL API。 这些服务围绕业务能力来划分构建的，并通过完全自动化部署机制来独立部署这些服务可以使用不同的编程语言，以及不同数据存储技术，以保证最低限度的集中式管理
微服务的特点 优点：">
<meta property="og:title" content="Spring Cloud" />
<meta property="og:description" content="Spring Cloud常用组件 服务的注册和发现。(eureka-netflix,nacos-spring官方,consul-alibaba) 服务的负载均衡。(ribbon,dubbo)
服务的相互调用。(openfegin,dubbo)
服务的容错。 (hystrix，sentinel)
服务网关。 (gateway，zuul)
服务配置的统一管理。(config-server,nacos,apollo)
服务消息总线。(bus)
服务安全组件。(security,Oauth2.0)
服务监控。(admin) (jvm)
链路追踪。(sleuth&#43;zipkin)
SpringCloud spring官方 netflix alibaba 其它 注册中心 consul eureka nacos apache/zookeeper 负载均衡 ribbon dubbo GRPC 远程调用 openFeign(集成ribbon) dubbo 熔断器 hystrix sentinel 网关 gateway zuul &mdash;&mdash;&mdash;- 配置文件中心 configServer nacos 携程/Apollo 监控组件 admin dubbo-admin 分布式事务 seata LCN/TCC/MQ 消息队列 stream rocketMq rabbitmq/kafka/activemq 微服务 不是一个框架，而是一构建思想。
它时用来描述将如那件应用程序设计为独立部署的服务的一种特殊方式。
微服务构架的系统是个 分布式系统，按业务领域划分为 独立的服务单元，有自动化运维、容错、快速演进的特点，它能够解决传统单体架构系统的痛点，同时也能满足越来越复杂的业务需求
什么是微服务？ 就是将一个大的应用，拆分成多个小的模块，每个模块都有自己的功能和职责，每个模块可以进行交互，这就是微服务
“微服务”的发明人，Martin Fowler的理解：
简而言之，微服务架构的风格，就是将单一程序开发成一个微服务每个微服务运行在自己的进程中，并使用 轻量级机制通信 ，通常是HTTP RESTFUL API。 这些服务围绕业务能力来划分构建的，并通过完全自动化部署机制来独立部署这些服务可以使用不同的编程语言，以及不同数据存储技术，以保证最低限度的集中式管理
微服务的特点 优点：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://x-windy.github.io/blog/2023/07/12/spring-cloud/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2023-07-12T23:33:21+08:00" />
<meta property="article:modified_time" content="2023-07-15T03:49:39+08:00" />
<meta itemprop="name" content="Spring Cloud">
<meta itemprop="description" content="Spring Cloud常用组件 服务的注册和发现。(eureka-netflix,nacos-spring官方,consul-alibaba) 服务的负载均衡。(ribbon,dubbo)
服务的相互调用。(openfegin,dubbo)
服务的容错。 (hystrix，sentinel)
服务网关。 (gateway，zuul)
服务配置的统一管理。(config-server,nacos,apollo)
服务消息总线。(bus)
服务安全组件。(security,Oauth2.0)
服务监控。(admin) (jvm)
链路追踪。(sleuth&#43;zipkin)
SpringCloud spring官方 netflix alibaba 其它 注册中心 consul eureka nacos apache/zookeeper 负载均衡 ribbon dubbo GRPC 远程调用 openFeign(集成ribbon) dubbo 熔断器 hystrix sentinel 网关 gateway zuul &mdash;&mdash;&mdash;- 配置文件中心 configServer nacos 携程/Apollo 监控组件 admin dubbo-admin 分布式事务 seata LCN/TCC/MQ 消息队列 stream rocketMq rabbitmq/kafka/activemq 微服务 不是一个框架，而是一构建思想。
它时用来描述将如那件应用程序设计为独立部署的服务的一种特殊方式。
微服务构架的系统是个 分布式系统，按业务领域划分为 独立的服务单元，有自动化运维、容错、快速演进的特点，它能够解决传统单体架构系统的痛点，同时也能满足越来越复杂的业务需求
什么是微服务？ 就是将一个大的应用，拆分成多个小的模块，每个模块都有自己的功能和职责，每个模块可以进行交互，这就是微服务
“微服务”的发明人，Martin Fowler的理解：
简而言之，微服务架构的风格，就是将单一程序开发成一个微服务每个微服务运行在自己的进程中，并使用 轻量级机制通信 ，通常是HTTP RESTFUL API。 这些服务围绕业务能力来划分构建的，并通过完全自动化部署机制来独立部署这些服务可以使用不同的编程语言，以及不同数据存储技术，以保证最低限度的集中式管理
微服务的特点 优点："><meta itemprop="datePublished" content="2023-07-12T23:33:21+08:00" />
<meta itemprop="dateModified" content="2023-07-15T03:49:39+08:00" />
<meta itemprop="wordCount" content="1840">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Spring Cloud"/>
<meta name="twitter:description" content="Spring Cloud常用组件 服务的注册和发现。(eureka-netflix,nacos-spring官方,consul-alibaba) 服务的负载均衡。(ribbon,dubbo)
服务的相互调用。(openfegin,dubbo)
服务的容错。 (hystrix，sentinel)
服务网关。 (gateway，zuul)
服务配置的统一管理。(config-server,nacos,apollo)
服务消息总线。(bus)
服务安全组件。(security,Oauth2.0)
服务监控。(admin) (jvm)
链路追踪。(sleuth&#43;zipkin)
SpringCloud spring官方 netflix alibaba 其它 注册中心 consul eureka nacos apache/zookeeper 负载均衡 ribbon dubbo GRPC 远程调用 openFeign(集成ribbon) dubbo 熔断器 hystrix sentinel 网关 gateway zuul &mdash;&mdash;&mdash;- 配置文件中心 configServer nacos 携程/Apollo 监控组件 admin dubbo-admin 分布式事务 seata LCN/TCC/MQ 消息队列 stream rocketMq rabbitmq/kafka/activemq 微服务 不是一个框架，而是一构建思想。
它时用来描述将如那件应用程序设计为独立部署的服务的一种特殊方式。
微服务构架的系统是个 分布式系统，按业务领域划分为 独立的服务单元，有自动化运维、容错、快速演进的特点，它能够解决传统单体架构系统的痛点，同时也能满足越来越复杂的业务需求
什么是微服务？ 就是将一个大的应用，拆分成多个小的模块，每个模块都有自己的功能和职责，每个模块可以进行交互，这就是微服务
“微服务”的发明人，Martin Fowler的理解：
简而言之，微服务架构的风格，就是将单一程序开发成一个微服务每个微服务运行在自己的进程中，并使用 轻量级机制通信 ，通常是HTTP RESTFUL API。 这些服务围绕业务能力来划分构建的，并通过完全自动化部署机制来独立部署这些服务可以使用不同的编程语言，以及不同数据存储技术，以保证最低限度的集中式管理
微服务的特点 优点："/>




<link rel="preload" href="/scss/main.min.6176d7d472a139a502a7c863de9bb7b87ef1ec9c271ff8f3d8ba4d983491b9ac.css" as="style">
<link href="/scss/main.min.6176d7d472a139a502a7c863de9bb7b87ef1ec9c271ff8f3d8ba4d983491b9ac.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-00000000-0');
}
</script>
  </head>
  <body class="td-page td-blog">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="navbar-brand__name">x-windy</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/blog/"><span>博客</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/docs/"><span>文档</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">中文</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/en/">English</a></li>
    <li><a class="dropdown-item" href="/ja/">日本語</a></li>
    </ul>
</div></li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search">
  <div class="td-search__icon"></div>
  <input type="search" class="td-search__input form-control td-search-input" placeholder="站内搜索…" aria-label="站内搜索…" autocomplete="off">
</div>

  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    <div class="td-search">
  <div class="td-search__icon"></div>
  <input type="search" class="td-search__input form-control td-search-input" placeholder="站内搜索…" aria-label="站内搜索…" autocomplete="off">
</div>

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <div class="td-sidebar-nav__section nav-item dropdown d-block d-lg-none">
      <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">中文</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/en/">English</a></li>
    <li><a class="dropdown-item" href="/ja/">日本語</a></li>
    </ul>
</div>
    </div>
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-blog-li">
  <a href="/blog/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-blog"><span class="">博客</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-blogjava-li">
  <a href="/blog/java/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-blogjava"><span class="">Java</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog10101-li">
  <a href="/blog/1/01/01/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog10101"><span class=""></span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog10101-li">
  <a href="/blog/1/01/01/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog10101"><span class=""></span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog10101jwt-li">
  <a href="/blog/1/01/01/jwt/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog10101jwt"><span class="">JWT</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog10101restful-li">
  <a href="/blog/1/01/01/restful/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog10101restful"><span class="">RESTful</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog10101ruoyi-li">
  <a href="/blog/1/01/01/ruoyi/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog10101ruoyi"><span class="">ruoyi</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog10101springsecurity-li">
  <a href="/blog/1/01/01/springsecurity/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog10101springsecurity"><span class="">SpringSecurity</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blogpython-li">
  <a href="/blog/python/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-blogpython"><span class="">Python</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-blogspring-boot-li">
  <a href="/blog/spring-boot/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-blogspring-boot"><span class="">Spring boot</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog10101ssm-li">
  <a href="/blog/1/01/01/ssm/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog10101ssm"><span class="">SSM</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-bloge697a5e8afad-li">
  <a href="/blog/%E6%97%A5%E8%AF%AD/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-bloge697a5e8afad"><span class="">日语</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-blog20230712spring-cloud-li">
  <a href="/blog/2023/07/12/spring-cloud/" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id="m-blog20230712spring-cloud"><span class="td-sidebar-nav-active-item">Spring Cloud</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog10101docker-li">
  <a href="/blog/1/01/01/docker/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog10101docker"><span class="">Docker</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-bloghugo-li">
  <a href="/blog/hugo/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-bloghugo"><span class="">Hugo</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog20230706e58786e5a487-li">
  <a href="/blog/2023/07/06/%E5%87%86%E5%A4%87/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog20230706e58786e5a487"><span class="">准备</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-blog10101redis-li">
  <a href="/blog/1/01/01/redis/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-blog10101redis"><span class="">Redis</span></a>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ms-2 pb-1 pt-2 mb-0">
<a href="https://github.com/x-windy/x-windy.github.io/tree/main/content/zh-cn/blog/Spring%20Cloud/Spring%20Cloud.md" class="td-page-meta--view" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> 查看页面源码</a>
  <a href="https://github.com/x-windy/x-windy.github.io/edit/main/content/zh-cn/blog/Spring%20Cloud/Spring%20Cloud.md" class="td-page-meta--edit" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> 编辑此页</a>
  <a href="https://github.com/x-windy/x-windy.github.io/new/main/content/zh-cn/blog/Spring%20Cloud/Spring%20Cloud.md?filename=change-me.md&amp;value=---%0D%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0D%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0D%0Aweight%3A&#43;100%0D%0Adescription%3A&#43;%3E-%0D%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0D%0A---%0D%0A%0D%0A%23%23&#43;Heading%0D%0A%0D%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0D%0A%0D%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0D%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0D%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0D%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0D%0A" class="td-page-meta--child" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> 添加子页面</a>
  <a href="https://github.com/x-windy/x-windy.github.io/issues/new?title=Spring%20Cloud" class="td-page-meta--issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> 提交文档问题</a>
  <a href="https://github.com/x-windy/x-windy.github.io/issues/new" class="td-page-meta--project-issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> 提交项目问题</a>
  <a id="print" href="https://x-windy.github.io/blog/_print/"><i class="fa-solid fa-print fa-fw"></i> 整节打印</a>

</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#微服务">微服务</a>
      <ul>
        <li><a href="#什么是微服务">什么是微服务？</a></li>
        <li><a href="#微服务的特点">微服务的特点</a></li>
        <li><a href="#cicd持续集成持续交付-运维">CI/CD(持续集成/持续交付) 运维</a></li>
        <li><a href="#微服务架构的设计原则项目搭建">微服务架构的设计原则(项目搭建)</a></li>
      </ul>
    </li>
    <li><a href="#spring-cloud">Spring Cloud</a>
      <ul>
        <li><a href="#spring-cloud介绍">Spring Cloud介绍</a></li>
        <li><a href="#spring-cloud版本对应关系">Spring Cloud版本对应关系</a></li>
        <li><a href="#spring-cloud常用组件表">Spring Cloud常用组件表</a></li>
        <li><a href="#spring-cloud实现方案">Spring Cloud实现方案</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    
            <div class="taxonomy taxonomy-terms-cloud taxo-tags">
      <h5 class="taxonomy-title">标签云</h5>
      <ul class="taxonomy-terms">
        <li><a class="taxonomy-term" href="https://x-windy.github.io/tags/java/" data-taxonomy-term="java"><span class="taxonomy-label">Java</span><span class="taxonomy-count">2</span></a></li>
        </ul>
    </div>
  <div class="taxonomy taxonomy-terms-cloud taxo-categories">
      <h5 class="taxonomy-title">分类</h5>
      <ul class="taxonomy-terms">
        <li><a class="taxonomy-term" href="https://x-windy.github.io/categories/effective-java/" data-taxonomy-term="effective-java"><span class="taxonomy-label">Effective Java</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://x-windy.github.io/categories/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4java%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C/" data-taxonomy-term="%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4java%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C"><span class="taxonomy-label">阿里巴巴Java开发手册</span><span class="taxonomy-count">1</span></a></li>
        </ul>
    </div>
  
	
          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5 pe-md-4" role="main">
            <a class="td-rss-button" title="RSS" href="https://x-windy.github.io/blog/index.xml" target="_blank" rel="noopener">
              <i class="fa-solid fa-rss" aria-hidden="true"></i>
            </a>
            
<div class="td-content">
	<h1>Spring Cloud</h1>
	
	<div class="td-byline mb-4">
		作者: <b>XW</b> |
		<time datetime="2023-07-12" class="text-muted">2023-7-12 23:33:21 周一 下午</time>
	</div>
	<header class="article-meta">
		
  </header>
	<h1 id="spring-cloud常用组件">Spring Cloud常用组件</h1>
<p><strong><font color="red">服务的注册和发现。(<code>eureka</code>-netflix,<code>nacos</code>-spring官方,<code>consul</code>-alibaba) </font></strong></p>
<p><strong>服务的负载均衡。(<code>ribbon</code>,<code>dubbo</code>)</strong></p>
<p>服务的相互调用。(<code>openfegin</code>,<code>dubbo</code>)</p>
<p>服务的容错。 (<code>hystrix</code>，<code>sentinel</code>)</p>
<p>服务网关。 (<code>gateway</code>，<code>zuul</code>)</p>
<p>服务配置的统一管理。(<code>config-server</code>,<code>nacos</code>,<code>apollo</code>)</p>
<p>服务消息总线。(<code>bus</code>)</p>
<p>服务安全组件。(<code>security</code>,<code>Oauth2.0</code>)</p>
<p>服务监控。(<code>admin</code>)  (<code>jvm</code>)</p>
<p>链路追踪。(<code>sleuth</code>+<code>zipkin</code>)</p>
<table>
<thead>
<tr>
<th>SpringCloud</th>
<th>spring官方</th>
<th>netflix</th>
<th>alibaba</th>
<th>其它</th>
</tr>
</thead>
<tbody>
<tr>
<td>注册中心</td>
<td>consul</td>
<td><font color="red">eureka</font></td>
<td><font color="red">nacos</font></td>
<td><font color="red">apache/zookeeper</font></td>
</tr>
<tr>
<td>负载均衡</td>
<td></td>
<td><font color="red">ribbon</font></td>
<td>dubbo</td>
<td>GRPC</td>
</tr>
<tr>
<td>远程调用</td>
<td><font color="red">openFeign(集成ribbon)</font></td>
<td></td>
<td>dubbo</td>
<td></td>
</tr>
<tr>
<td>熔断器</td>
<td></td>
<td><font color="red">hystrix</font></td>
<td><font color="red">sentinel</font></td>
<td></td>
</tr>
<tr>
<td>网关</td>
<td><font color="red">gateway</font></td>
<td>zuul</td>
<td>&mdash;&mdash;&mdash;-</td>
<td></td>
</tr>
<tr>
<td>配置文件中心</td>
<td>configServer</td>
<td></td>
<td><font color="red">nacos</font></td>
<td>携程/Apollo</td>
</tr>
<tr>
<td>监控组件</td>
<td><font color="red">admin</font></td>
<td></td>
<td>dubbo-admin</td>
<td></td>
</tr>
<tr>
<td>分布式事务</td>
<td></td>
<td></td>
<td><font color="red">seata</font></td>
<td><font color="red">LCN/TCC/MQ</font></td>
</tr>
<tr>
<td>消息队列</td>
<td>stream</td>
<td></td>
<td><font color="red">rocketMq</font></td>
<td><font color="red">rabbitmq/kafka/activemq</font></td>
</tr>
</tbody>
</table>
<h2 id="微服务">微服务</h2>
<blockquote>
<p>不是一个框架，而是一构建思想。</p>
<p>它时用来描述将如那件应用程序设计为独立部署的服务的一种特殊方式。</p>
<p>微服务构架的系统是个 <strong><font color="red">分布式系统</font></strong>，按业务领域划分为 <strong><font color="red">独立的服务单元</font></strong>，有自动化运维、容错、快速演进的特点，它能够解决传统单体架构系统的痛点，同时也能满足越来越复杂的业务需求</p>
</blockquote>
<h3 id="什么是微服务">什么是微服务？</h3>
<p>就是将一个大的应用，拆分成多个小的模块，每个模块都有自己的功能和职责，每个模块可以进行交互，这就是微服务</p>
<p>“微服务”的发明人，<code>Martin Fowler</code>的理解：</p>
<blockquote>
<p>简而言之，微服务架构的风格，就是将单一程序开发成一个微服务每个微服务运行在自己的进程中，并使用 <font color="red"><strong>轻量级机制通信</strong> </font>，通常是<strong>HTTP RESTFUL API</strong>。
这些服务围绕业务能力来划分构建的，并通过完全自动化部署机制来独立部署这些服务可以使用不同的编程语言，以及不同数据存储技术，以保证最低限度的集中式管理</p>
</blockquote>
<h3 id="微服务的特点">微服务的特点</h3>
<p>优点：</p>
<p>1.按业务(功能)划分为一个独立运行的程序，即服务单元
2.服务之间通过 HTTP 协议相互通信。 http 是一个万能的协议 (web 应用都支持的模式)
3.自动化部署
4.可以用不同的编程语言
5.可以用不同的存储技术
6.服务集中化管理。
7.微服务是一个分布式系统</p>
<p>缺点：</p>
<p>1.微服务的<strong>复杂度</strong>
2.分布式<strong>事务问题</strong>
3.服务的划分(按照<strong>功能</strong>划分 还是按照<strong>组件</strong>来划分呢) 分工</p>
<p>4.服务的<strong>部署</strong>(不用自动化部署 自动化部署)</p>
<h3 id="cicd持续集成持续交付-运维">CI/CD(持续集成/持续交付) 运维</h3>
<blockquote>
<p>微服务的自动化部署，部署多个jar包</p>
</blockquote>
<p>开源软件项目:<code>Jenkins</code></p>
<h3 id="微服务架构的设计原则项目搭建">微服务架构的设计原则(项目搭建)</h3>
<blockquote>
<p><strong>开闭原则 单一原则</strong>  六大设计原则架构设计和代码设计思路一样的</p>
<p>23种设计模式</p>
</blockquote>
<p>在微服务架构中的三大难题：<strong>服务故障的传播性(熔断)、服务的划分和分布式事务</strong>。</p>
<h2 id="spring-cloud">Spring Cloud</h2>
<h3 id="spring-cloud介绍">Spring Cloud介绍</h3>
<p>Spring cloud 作为 Java 语言的微服务框架，它依赖于 Spring Boot，有快速开发、持续交付和容易部署等特点。</p>
<p>开源社区Spring官方和Netflix、Pivotal、alibaba提供支持</p>
<p>Spring cloud 的<strong>首要目标就是通过提供一系列开发组件和框架，帮助开发者迅速搭建一个分布式的微服务系统。</strong></p>
<p>Spring cloud 是通过包装其他技术框架来实现的，例如包装开源的 Netflix oss 组件，实现了一套通过基于注解、 Java 配置和基于模版开发的微服务框架。</p>
<p>spring cloud 提供了开发分布式微服务系统的一些常用组件，例如服务注册和发现、配置中心、熔断器、远程调用，智能路由、微代理、控制总线、全局锁、分布式会话等。</p>
<h3 id="spring-cloud版本对应关系">Spring Cloud版本对应关系</h3>
<p>命名：ABCDE<strong>FGH</strong>I(2020版)</p>
<p>新版本：年份命名</p>
<p><img src="Spring%20Cloud.assets/image-20230713003533882-16891797348915.png" alt="image-20230713003533882"></p>
<p>Spring Cloud和Spring Boot版本对应关系：</p>
<p><a href="https://spring.io/projects/spring-cloud#learn">Spring Cloud</a></p>
<p><a href="https://start.spring.io/actuator/info">start.spring.io/actuator/info</a></p>
<p>Alibaba Spring Cloud支持版本对应：</p>
<p><a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E/662c076ef8f4af0ec94caa86ade169442684904f">版本说明 · alibaba/spring-cloud-alibaba Wiki (github.com)</a></p>
<h3 id="spring-cloud常用组件表">Spring Cloud常用组件表</h3>
<p><strong><font color="red">服务的注册和发现。(<code>eureka</code>-netflix,<code>nacos</code>-spring官方,<code>consul</code>-alibaba) </font></strong></p>
<p><strong>服务的负载均衡。(<code>ribbon</code>,<code>dubbo</code>)</strong></p>
<p>服务的相互调用。(<code>openfegin</code>,<code>dubbo</code>)</p>
<p>服务的容错。 (<code>hystrix</code>，<code>sentinel</code>)</p>
<p>服务网关。 (<code>gateway</code>，<code>zuul</code>)</p>
<p>服务配置的统一管理。(<code>config-server</code>,<code>nacos</code>,<code>apollo</code>)</p>
<p>服务消息总线。(<code>bus</code>)</p>
<p>服务安全组件。(<code>security</code>,Oauth2.0)</p>
<p>服务监控。(<code>admin</code>)  (<code>jvm</code>)</p>
<p>链路追踪。(<code>sleuth</code>+<code>zipkin</code>)</p>
<h4 id="服务的注册和发现eureka">服务的注册和发现(Eureka)</h4>
<blockquote>
<p>注册发现中心
Eureka 来源于古希腊词汇，意为“发现了”。在软件领域，Eureka 是 <strong>Netflix 在线影片公司</strong>开源的一个<strong>服务注册与发现的组件</strong>，和其他Netflix 公司的服务组件 (例如负载均衡熔断器、网关等) 一起，被Spring cloud 社区整合为 <strong>Spring cloud Netflix 模块</strong>。Eureka 是Netflix 贡献给 Spring cloud 的一个框架!</p>
<p>Netflix 给 Spring cloud 贡献了很多框架</p>
</blockquote>
<h5 id="spring-cloud-eureka-和-zookeeper的区别">Spring Cloud Eureka 和 Zookeeper的区别</h5>
<h6 id="什么是-cap-原则面试">什么是 CAP 原则(面试)</h6>
<p>在分布式微服务里面CAP定理
<code>问: 为什么 zookeeper 不适合做注册中心?</code>
CAP 原则又称 CAP 定理，指的是在一个分布式系统中
<strong><font color="red">一致性</font> (Consistency)</strong> :</p>
<p>三个机器中的数据中一致的 <code>C</code>
<strong><font color="red">可用性</font> (Availability)</strong> :</p>
<p>当有一个节点挂掉了整个集群可以继续对外提供服务<code>A</code>
<strong><font color="red">分区容错性</font> (Partition tolerance) (这个特性是不可避免的)</strong></p>
<p>由于机房网络或者分区等原因会导致各个机器中的数据短暂不一致<code>P</code></p>
<p><strong><font color="red">CAP 原则指的是，这三个要素最多只能同时实现两点，不可能三者兼顾</font></strong></p>
<p>CP(数据是一致的但如果有节点挂了，整个服务在几分钟的时间内不能提供服务)</p>
<p>AP(数据可能是不一致的)</p>
<blockquote>
<p>Eureka和Zookeeper区别：</p>
<p>Zookeeper遵循CP原则</p>
<p>Eureka遵循AP原则(高可用)</p>
</blockquote>
<h5 id="搭建一个注册中心">搭建一个注册中心</h5>
<h6 id="eureka-server"><code>eureka-server</code></h6>
<blockquote>
<p>注册中心：可用让别人注册，还可以自己注册自己</p>
</blockquote>
<p>Springboot项目导包：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-server<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>1.<code>pom.xml</code></p>
<blockquote>
<p>springboot和sprincloud版本对应</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-boot-starter-parent<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;version&gt;</span>2.3.12.RELEASE<span style="color:#204a87;font-weight:bold">&lt;/version&gt;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;spring-cloud.version&gt;</span>Hoxton.SR12<span style="color:#204a87;font-weight:bold">&lt;/spring-cloud.version&gt;</span>
</span></span></code></pre></div><p>2.<code>application.properties</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># eureka端口 默认8761</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">server.port</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">8761</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 应用名称 一般：eureka-server</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">spring.application.name</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">eureka-server</span>
</span></span></code></pre></div><p>3.<code>EurekaServerApplication</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 开启eureka注册中心的功能
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#5c35cc;font-weight:bold">@EnableEurekaServer</span>
</span></span></code></pre></div><p>启动springboot，访问http://localhost:8761/</p>
<p><img src="Spring%20Cloud.assets/image-20230713142920735-16892297661181.png" alt="image-20230713142920735"></p>
<p>实例ID：localhost:eureka-server:8761</p>
<h6 id="eureka-client-a"><code>eureka-client-a</code></h6>
<blockquote>
<p>客户端a</p>
</blockquote>
<p>Springboot导包：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span> 		<span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-client<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>1.<code>pom.xml</code></p>
<blockquote>
<p>springboot和sprincloud版本对应</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-boot-starter-parent<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;version&gt;</span>2.3.12.RELEASE<span style="color:#204a87;font-weight:bold">&lt;/version&gt;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;spring-cloud.version&gt;</span>Hoxton.SR12<span style="color:#204a87;font-weight:bold">&lt;/spring-cloud.version&gt;</span>
</span></span></code></pre></div><p>2.<code>application.properties</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 客户端端口无要求</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">server.port</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">8080</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 应用名称</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">spring.application.name</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">eureka-server-a</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 注册：将信息(ip和port等)发送到注册中心</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 指定注册地址</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.service-url.defaultZone</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">http://localhost:8761/eureka</span>
</span></span></code></pre></div><p>3.<code>EurekaClientAApplication</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 开启客户端的功能
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#5c35cc;font-weight:bold">@EnableEurekaClient</span>
</span></span></code></pre></div><p>启动：</p>
<p><img src="Spring%20Cloud.assets/image-20230713144713741-16892308346772.png" alt="image-20230713144713741"></p>
<p><code>eureka-client-b</code>客户端b</p>
<blockquote>
</blockquote>
<h6 id="配置文件">配置文件</h6>
<blockquote>
<p>eureka三类配置：server client instance</p>
</blockquote>
<p>服务端配置</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># eureka端口 默认8761</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">server.port</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">8761</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 应用名称 一般：eureka-server</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">spring.application.name</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">eureka-server</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 服务端间隔多少毫秒做定期删除的操作</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.server.eviction-interval-timer-in-ms</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">10000</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 续约百分比</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.server.renewal-percent-threshold</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">0.85</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 主机名称：应用名称：端口号</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.instance.instance-id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">${eureka.instance.hostname}:${eureka.instance.name}:${server.port}</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 主机名称/服务IP</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.instance.hostname</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">localhost</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 以IP的形式显示具体的服务信息</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.instance.prefer-ip-address</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">true</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 服务实例(eureka-server即使服务端也是客户端)的续约时间间隔</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.instance.lease-renewal-interval-in-seconds</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">5</span>
</span></span></code></pre></div><p>客户端配置</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 客户端端口无要求</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">server.port</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">8080</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 应用名称</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">spring.application.name</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">eureka-server-a</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 指定注册地址</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.service-url.defaultZone</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">http://localhost:8761/eureka</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># eureka-server注册开关</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.register-with-eureka</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">true</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 应用是否拉去服务列表到本地</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.fetch-registry</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">true</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 为了缓解服务列表的脏读问题，时间越短藏独越少 性能消耗越大</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.registry-fetch-interval-seconds</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">10</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 应用的主机名称(主机IP)</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.instance.hostname</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">localhost</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.instance.instance-id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">${eureka.instance.hostname}:${spring.application.name}:${server.port}</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 显示IP</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.instance.prefer-ip-address</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">true</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 续约时间</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.instance.lease-renewal-interval-in-seconds</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">10</span>
</span></span></code></pre></div><h5 id="高可用的eureka-server集群">高可用的Eureka-Server集群</h5>
<blockquote>
<p>复制配置文件</p>
</blockquote>
<p>集群的方案：中心化集群、主从模式集群、去中心化集群</p>
<h6 id="注册中心集群去中心化集群">注册中心集群（去中心化集群）</h6>
<blockquote>
<p>没有主从概念。eureka会将数据进行广播和扩散**（相互注册）**</p>
</blockquote>
<p><code>eureka-server-A、eureka-server-B、eureka-server-C</code></p>
<blockquote>
<p>应用名称不变</p>
<p>端口 8761、8762、8763</p>
<p>开启注解@EnableEurekaServer</p>
</blockquote>
<p><code>eureka-server-A</code>——<code>application.properties</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 默认在8761注册</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.service-url.defaultZone</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">http://localhost:8762/eureka,http://localhost:8763/eureka</span>
</span></span></code></pre></div><p><code>eureka-server-B</code>——<code>application.properties</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 默认在8761注册</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.service-url.defaultZone</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">http://localhost:8761/eureka,http://localhost:8763/eureka</span>
</span></span></code></pre></div><p><code>eureka-server-C</code>——<code>application.properties</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 默认在8761注册</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.service-url.defaultZone</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">http://localhost:8761/eureka,http://localhost:8762/eureka</span>
</span></span></code></pre></div><p><img src="Spring%20Cloud.assets/image-20230715021754379-16893586759521.png" alt="image-20230715021754379"></p>
<p><img src="Spring%20Cloud.assets/image-20230715022703622-16893592243142.png" alt="image-20230715022703622"></p>
<p>准备三个台服务器，将eureka-server部署到三个不同的服务器里，实现集群。</p>
<p>一台电脑模拟集群，本地修改<code>host</code>文件</p>
<p><code>C:\Windows\System32\drivers\etc\HOSTS</code></p>
<pre tabindex="0"><code>127.0.0.1 peer1
127.0.0.1 peer2
127.0.0.1 peer3
</code></pre><p>虚拟映射地址</p>
<p>修改各自的配置文件<code>application.properties</code>的主机名和注册地址</p>
<p><img src="Spring%20Cloud.assets/image-20230715022822204-16893593033343.png" alt="image-20230715022822204"></p>
<p>客户端修改配置文件<code>application.properties</code>向eureka-server注册</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.service-url.defaultZone</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">http://peer1:8761/eureka,http://peer2:8762/eureka,http://peer3:8763/eureka</span>
</span></span></code></pre></div><p><img src="Spring%20Cloud.assets/image-20230715030244727-16893613661814.png" alt="image-20230715030244727"></p>
<h6 id="分布式数据一致性协议paxos-raft主从模式集群">分布式数据一致性协议<code>Paxos</code> <code>raft</code>(主从模式集群)</h6>
<blockquote>
<p>在有主从模式的集群中，遵循这这些协议</p>
<p><a href="http://thesecretlivesofdata.com/raft/">Raft (thesecretlivesofdata.com)</a></p>
</blockquote>
<p>1.数据同步更新</p>
<p>Raft：客户端A将数据1&mdash;-&gt;主节点：服务端A(数据1存放到日志中，未更新节点的值)&mdash;-&gt;副节点：服务端B&hellip;&mdash;-&gt;回应主节点(主节点更新)&mdash;-&gt;副节点更新</p>
<blockquote>
<p>当集群中的大部分节点，都做出了响应时，进行同步</p>
</blockquote>
<p>2.主节点选举</p>
<p>每个节点都有一个随机的苏醒时间，谁先苏醒谁成为候选节点(给自己投一票)，候选节点向其它节点发送投票请求，接收节点未投票则将票投给候选节点，候选节点获得多数票时成为领导者(主节点)</p>
<p>主节点向所有副节点发送心跳（数据同步更新），当主节点宕机后，副节点重新选举。</p>
<blockquote>
<p>当有两个节点同时成为候选节点，则重新洗牌(重置苏醒时间)</p>
</blockquote>
<h5 id="eureka-概念的理解">Eureka 概念的理解</h5>
<ol>
<li>服务的注册
当项目启动时 (<strong>eureka的客户端</strong>)，就会向 <code>eureka-server</code> 发送自己的<strong>元数据 (原始数据)</strong><font color="red">(运行的ip，端口 port，健康的状态监控等，因为使用的是 <code>http/ResuFul</code>请求风格)</font><code>eureka-server</code> 会在<strong>自己内部保留这些元数据</strong>(内存中)。(有一个服务列表) (<code>restful</code> 风格，以http动词(<strong>GET（获取资源）、POST（创建资源）、PUT（更新资源）和DELETE（删除资源）</strong>)的请求方式，完成对url资源的操作)</li>
</ol>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/617187396">一文详解RESTful风格 - 知乎 (zhihu.com)</a></p>
</blockquote>
<ol>
<li>
<p>服务的续约</p>
<p>项目启动成功了，除了向<code>eureka-server</code> 注册自己成功，还会<strong>定时</strong>的向<code>eureka-serve</code>r汇报自己，<strong>心跳</strong>，表示自己还活着。(修改一个时间)</p>
</li>
<li>
<p>服务的下线(主动下线)
当项目关闭时，会给 <code>eureka-server</code> 报告，说明自己要下机了</p>
</li>
<li>
<p>服务的剔除(被动下线，主动剔除)
当项目<strong>超过了指定时间</strong>没有向 <code>eureka-server</code> 汇报自己，那么 <code>eureka-server</code> 就会认为此节点死掉了，会把它剔除掉，也不会放流量和请求到此节点了</p>
</li>
</ol>
<h5 id="eureka注册理解registry">Eureka注册理解registry</h5>
<blockquote>
<p>客户端发送注册请求(<strong>POST</strong>)</p>
<p>服务端接收客户端的注册请求</p>
</blockquote>
<p>保存服务实例数据的集合：</p>
<p>第一个key：应用名称(全大写)</p>
<p>Value中的Map的key：应用实例ID</p>
<p>Value中的Map的Value：具体的服务节点信息</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">ConcurrentHashMap</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#000">Map</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#000">Lease</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">InstanceInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;&gt;</span> <span style="color:#000">registry</span>
</span></span></code></pre></div><h5 id="eureka续约renew">Eureka续约renew</h5>
<p>客户端发送时间</p>
<p>服务端更新时间（当前时间+续约时间）</p>
<h5 id="eureka剔除">Eureka剔除</h5>
<p>当前时间＞（更新时间+续约时间）</p>
<h5 id="eureka服务发现">Eureka服务发现</h5>
<blockquote>
<p>clientA 通过服务的应用名称(例如：clientB)找到服务的具体实例的过程</p>
</blockquote>
<p>编写Controller发现接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">DiscoveryController</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">private</span> <span style="color:#000">DiscoveryClient</span> <span style="color:#000">discoveryClient</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;test&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">discovery</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span> <span style="color:#000">serverName</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// 服务发现
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ServiceInstance</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">instances</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">discoveryClient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstances</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">serverName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">instances</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">forEach</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">println</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">instances</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#ce5c00;font-weight:bold">).</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>访问接口：<a href="http://localhost:8080/test?serverName=eureka-client-b">localhost:8080/test?serverName=eureka-client-b</a></p>
<p>返回：</p>
<pre tabindex="0"><code>[EurekaDiscoveryClient.EurekaServiceInstance@75bc3ce1 instance = InstanceInfo [instanceId = localhost:eureka-client-b:8081, appName = EUREKA-CLIENT-B, hostName = 192.168.121.1, status = UP, ipAddr = 192.168.121.1, port = 8081, securePort = 443, dataCenterInfo = com.netflix.appinfo.MyDataCenterInfo@4dc123b5]
</code></pre><p>获取IP和端口，即可调用clientB的接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">ServiceInstance</span> <span style="color:#000">serviceInstance</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">instances</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span> <span style="color:#8f5902;font-style:italic">// 获取IP和端口
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span> <span style="color:#000">host</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">serviceInstance</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getHost</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">port</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">serviceInstance</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getPort</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">host</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;:&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">port</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><h5 id="docker">Docker</h5>
<p>Eureka-Server服务器(jar包)到Docker镜像部署</p>
<p><code>eureka-server-1.0.jar</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.service-url.defaultZone</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">${EUREKA_SERVER_URL:http://peer1:8761/eureka}</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">eureka.client.register-with-eureka</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">${REGISTER_WITH_EUREKA:true}</span>
</span></span></code></pre></div><pre tabindex="0"><code>mkdir eureka-server
cd eureka-server
pwd
# 获取路径workdir
</code></pre><p><code>Dockerfile</code></p>
<pre tabindex="0"><code>FROM openjdk:8
# 环境变量
ENV workdir=/PAYH
# 将当前目录拷贝到workdir
COPY . ${workdir}
# 切换到workdir
WORKDIR ${workdir}
# 端口
EXPOSE 8761
CMD [&#34;java&#34;,&#34;-jar&#34;,&#34;eureka-server.jar&#34;]
</code></pre><p>run.sh</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 基于文件夹 -t:tag</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> .. <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> docker build ./eureka-server -t eureka-server:1.0
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>chmod <span style="color:#0000cf;font-weight:bold">777</span> run.sh
</span></span><span style="display:flex;"><span>./run.sh
</span></span><span style="display:flex;"><span>doucker run --name eureka-server -p 8761:8761 -e <span style="color:#000">REGISTER_WITH_EUREKA</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87">false</span> -d eureka-server:1.0
</span></span><span style="display:flex;"><span>docker logs eureka-server
</span></span></code></pre></div><p><code>run -p 端口 -d 后台运行(守护) --link 指定网络host文件映射的 -e REGISTER_WITH_EUREKA=false(指定参数) -v 文件挂载</code></p>
<h5 id="resttemplate使用">restTemplate使用</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span> <span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.projectlombok<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>lombok<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;optional&gt;</span>true<span style="color:#204a87;font-weight:bold">&lt;/optional&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>编写测试接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">TestController</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;testGet&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;ok&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * post接收参数
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 1.json数据
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * header content-type=application/json
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @RequestBody User user
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 加注解
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 2.表单数据
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * header content-type=x-www-form-undercode
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * User user
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 不加注解
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@PostMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;testPost&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">testPost</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestBody</span> <span style="color:#000">User</span> <span style="color:#000">user</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;ok&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@PostMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;testPost2&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">testPost2</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">User</span> <span style="color:#000">user</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;ok&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>使用restTemplate发起请求</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">testGet</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">RestTemplate</span> <span style="color:#000">restTemplate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">RestTemplate</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">String</span> <span style="color:#000">url</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;http://localhost:8080/testGet?name=zq&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">String</span> <span style="color:#000">object</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">restTemplate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForObject</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">url</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">object</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">testGet2</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">RestTemplate</span> <span style="color:#000">restTemplate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">RestTemplate</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">String</span> <span style="color:#000">url</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;http://localhost:8080/testGet?name=zq&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">ResponseEntity</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">responseEntity</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">restTemplate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForEntity</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">url</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// http:// 协议(规范,接头暗号)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// 包含：请求头、请求参数、响应头、响应状态码、报文等。。。
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">responseEntity</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// &lt;200,ok,[Content-Type:&#34;text/plain;charset=UTF-8&#34;, Content-Length:&#34;2&#34;, Date:&#34;Sun, 16 Jul 2023 18:36:25 GMT&#34;, Keep-Alive:&#34;timeout=60&#34;, Connection:&#34;keep-alive&#34;]&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 表单参数传参
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#5c35cc;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">testPost2</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">RestTemplate</span> <span style="color:#000">restTemplate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">RestTemplate</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">String</span> <span style="color:#000">url</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;http://localhost:8080/testPost2&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// 构建表单参数
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">LinkedMultiValueMap</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Object</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">map</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">LinkedMultiValueMap</span><span style="color:#ce5c00;font-weight:bold">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">map</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#4e9a06">&#34;zq&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">map</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;age&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">20</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">String</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">restTemplate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">postForObject</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">url</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">map</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">s</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="客户端负载均衡工具ribbon">客户端负载均衡工具(Ribbon)</h4>
<blockquote>
<p>Spring Cloud Ribbon是一个基于HTTP和TCP的客户端<strong>负载均衡</strong>工具</p>
<p>将面向服务的REST模板请求自动转换成客户端负载均衡的服务调用</p>
<p>负载均衡的算法：轮询(请求次数 % 机器数量)、iphash、权重、随机</p>
<p>响应时间最短轮询、并发量最小轮询、过滤出符合条件的轮询、区域内亲和轮询算法</p>
<p>Ribbon是netfix公司的一个开源项目，主要功能：<strong>提供客户端负载均衡算法和服务调用</strong></p>
<p>两种方法结合使用：</p>
<ol>
<li>
<p>RestTemplate</p>
</li>
<li>
<p>Openfegin</p>
</li>
</ol>
</blockquote>
<p>负载均衡</p>
<blockquote>
<p>Load Balance(LB)</p>
<p>http://（http协议）</p>
<p>lb://（负载均衡协议）</p>
<p>将负载（工作任务）进行平衡、分摊到 多个操作单元上进行运行</p>
</blockquote>
<h5 id="ribbon的使用">Ribbon的使用</h5>
<blockquote>
<p>先启动提供者，再启动消费者（不然消费者会先拉去注册中心的服务信息，没有启动者的服务信息）</p>
</blockquote>
<p><code>provider</code> <code>provider-b</code> 接口提供者</p>
<blockquote>
<p>eureka客户端</p>
</blockquote>
<p><img src="Spring%20Cloud.assets/image-20230725132719884-16902628418271.png" alt="image-20230725132719884"></p>
<p><code>application.yml</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 集群，端口不同</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">server</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8080</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># 应用名一样</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">spring</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">application</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">eureka</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">client</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">service-url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">defaultZone</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://localhost:8761/eureka</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">instance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">hostname</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">localhost</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">prefer-ip-address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">instance-id</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${eureka.instance.hostname}:${spring.application.name}:${server.port}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><code>ProviderController.java</code> 提供同样的接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">ProviderController</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;hello&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">hello</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;provider的接口&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p><code>consumer</code> 接口消费者，用户，使用ribbon达到负载均衡的效果</p>
<p><code>application.yml</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 集群，端口不同</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">server</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8082</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># 应用名一样</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">spring</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">application</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consumer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">eureka</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">client</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">service-url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">defaultZone</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://localhost:8761/eureka</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">instance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">hostname</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">localhost</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">prefer-ip-address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">instance-id</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${eureka.instance.hostname}:${spring.application.name}:${server.port}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>将<code>restTemplate</code>给<code>springboot</code>和<code>ribbon</code>托管</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@LoadBalanced</span> <span style="color:#8f5902;font-style:italic">// 被ribbon接管
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">RestTemplate</span> <span style="color:#000">restTemplate</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">RestTemplate</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p><code>ConsumerController.java</code> 测试接口，使用服务名进行调用</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">ConsumerController</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// 自动装配
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#5c35cc;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">private</span> <span style="color:#000">RestTemplate</span> <span style="color:#000">restTemplate</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * ribbon
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 1.拦截这个请求
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 2.截取主机名称 serverName
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 3.借助eureka来做服务发现  List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(serverName);
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 4.通过负载均衡算法，拿其中一个服务ip,port
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 5.reConstructURL 重构地址( http://localhost:8080/hello)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 6.发起请求
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @param serviceName
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;testRibbon&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">testRibbon</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span> <span style="color:#000">serviceName</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// 根据服务名来调用，不需要写端口号，ribbon帮忙负载均衡，默认算法：轮询
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// http://provider/hello
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">String</span> <span style="color:#000">object</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">restTemplate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForObject</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">serviceName</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;/hello&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">object</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="负载均衡和远程调用">负载均衡和远程调用</h5>
<blockquote>
<p>访问不同的服务，可以使用不同的算法规则</p>
<p><code>shift+shift</code>查询<code>IRule</code>算法接口 ,实现接口可自定义算法</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 自定义的负载均衡算法</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">provider</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 提供者的服务名称</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">ribbon</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">NFLoadBalancerRuleClassName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">com.netflix.loadbalancer.RandomRule</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 几种算法的全限定类名</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 提供者算法全局变量，自定义算法
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">IRule</span> <span style="color:#000">myRule</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">RandomRule</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="ribbon默认的配置类defaultclientconfigimpl">Ribbon默认的配置类：DefaultClientConfigImpl</h5>
<pre tabindex="0"><code class="language-YML" data-lang="YML">ribbon:
  eureka:
    enabled: true   # 开启eureka支持
  eager-load:
    enabled: false   # 加载模式 第一次访问的时候(false)或者第一次启动的时间(true)访问eureka服务列表
  http:   # ribbon使用restTemplate封装了java.net.HttpUrlConnection发送的请求(不支持连接池)
    client:   # 发送请求的工具有很多 httpClient(支持连接池) 添加依赖(使用其它工具)
      enabled: false
  okhttp:   # 也是请求工具，在移动端用的多
    enabled: false
</code></pre><p>总结：</p>
<blockquote>
<p>ILoadBalancer接口：</p>
<p>从eureka拉取服务列表，使用IRule算法实现客户端调用的负载均衡</p>
</blockquote>
<h4 id="声明式注解web服务客户端openfegin">声明式(注解)web服务客户端(Openfegin)</h4>
<blockquote>
<p><strong>是完成服务之间调用的组件</strong>(远程调用的组件)http调用</p>
<p>使用fegin创建一个接口并进行注解(包含：fegin和JAX-RS注解)</p>
<p>还支持可热拔编码器和解码器。</p>
<p><code>fegin</code>集成了<code>Ribbon</code>(Ribbon集成了eureka)</p>
</blockquote>
<blockquote>
<p>微服务思想：<strong>我不会，别人会，我去调用别人</strong></p>
<p>前端——》user-sevice(/userOrder)——》RPC(fegin远程过程调用HTTP协议通信)——》order-service(/doOrder)</p>
<p>fegin默认等待时间为1s</p>
<p>超过1s报错超时</p>
</blockquote>
<pre tabindex="0"><code>Whitelabel Error Page
This application has no explicit mapping for /error, so you are seeing this as a fallback.

Wed Jul 26 23:10:29 CST 2023
There was an unexpected error (type=Internal Server Error, status=500).
</code></pre><p>配置fegin超时时间</p>
<h5 id="order-service"><code>order-service</code></h5>
<p><code>pom.xml</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-client<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.projectlombok<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>lombok<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;optional&gt;</span>true<span style="color:#204a87;font-weight:bold">&lt;/optional&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p><code>application.yml</code></p>
<pre tabindex="0"><code class="language-YML" data-lang="YML">server:
  port: 8080
spring:
  application:
    name: order-service
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka
</code></pre><p><code>OrderController.java</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">OrderController</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;doOrder&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">doOrder</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;订单-01麻辣香锅&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="user-service"><code>user-service</code></h5>
<blockquote>
<p>开启fegin的客户端功能 才可以发送远程调用</p>
<p>@EnablefeginClients</p>
</blockquote>
<p><code>UserServiceApplication</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@SpringBootApplication</span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@EnableEurekaClient</span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@EnablefeginClients</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">UserServiceApplication</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">SpringApplication</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">run</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">UserServiceApplication</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p><code>pom.xml</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-client<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-cloud-starter-openfegin<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.projectlombok<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>lombok<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;optional&gt;</span>true<span style="color:#204a87;font-weight:bold">&lt;/optional&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p><code>application.yml</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">server</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8081</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">spring</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">application</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">user-service</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">eureka</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">client</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">service-url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">defaultZone</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://localhost:8761/eureka</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><code>UserController</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">UserController</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 动态代理 jdk(java interface 接口 $Proxy) /cglib(subClass 子类)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * jdk动态代理 只要是代理对象调用的方法必须走invoke方法(InvocationHandler类里的)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * java.lang.reflect.InvocationHandler#invoke(java.lang.Object, java.lang.reflect.Method, java.lang.Object[])
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *                       (代理对象,调用方法,调用方法参数)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *  public Object invoke(Object proxy, Method method, Object[] args)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">UserOrderfegin</span> <span style="color:#000">userOrderfegin</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;userOrder&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">userOrder</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;用户下单&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// 发起远程调用
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">String</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">userOrderfegin</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">doOrder</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">s</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p><code>fegin/UserOrderfegin.java</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// User模块调用Order模块的fegin
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// value = &#34;order-service&#34; 服务提供者的应用名称
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#5c35cc;font-weight:bold">@feginClient</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;order-service&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">interface</span> <span style="color:#000">UserOrderfegin</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// 需要调用哪个接口
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     写方法签名：
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     (注解)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     @GetMapping(&#34;doOrder&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     (修饰符 返回值 方法名 方法参数)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     public String doOrder();
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;doOrder&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">doOrder</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="fegin原理">fegin原理</h5>
<blockquote>
<p>jdk动态代理 + ribbon + restTemplate</p>
<p>使用代理拦截方法，获取方法上的<code>GetMapping</code>注解的值(接口)</p>
<p>获取类上的<code>feginClient</code>注解的值(应用名)</p>
<p>拼接调用地址http://applicationName/api</p>
<p>使用ribbon远程调用</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@SpringBootTest</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">UserServiceApplicationTests</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">private</span> <span style="color:#000">RestTemplate</span> <span style="color:#000">restTemplate</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">contextLoads</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">UserOrderfegin</span> <span style="color:#000">o</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">UserOrderfegin</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">Proxy</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newProxyInstance</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">UserController</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getClassLoader</span><span style="color:#ce5c00;font-weight:bold">(),</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Class</span><span style="color:#ce5c00;font-weight:bold">[]{</span><span style="color:#000">UserOrderfegin</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">},</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">InvocationHandler</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#5c35cc;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">Object</span> <span style="color:#000">invoke</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Object</span> <span style="color:#000">proxy</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Method</span> <span style="color:#000">method</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Object</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">throws</span> <span style="color:#000">Throwable</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8f5902;font-style:italic">// 服务发现，拿到ip、port和方法注解的值value
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">method</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getName</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8f5902;font-style:italic">// 获取GetMapping注解的值
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000">GetMapping</span> <span style="color:#000">annotation</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">method</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getAnnotation</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">GetMapping</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">annotation</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">value</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8f5902;font-style:italic">// 获取第一个值
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000">String</span> <span style="color:#000">path</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">value</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#ce5c00;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8f5902;font-style:italic">// 获取声明类
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000">Class</span><span style="color:#ce5c00;font-weight:bold">&lt;?&gt;</span> <span style="color:#000">aClass</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">method</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDeclaringClass</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8f5902;font-style:italic">// 获取类的名字
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000">String</span> <span style="color:#000">name1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">aClass</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getName</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8f5902;font-style:italic">// 获取声明类的feginClient注解
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000">feginClient</span> <span style="color:#000">annotation1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">aClass</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getAnnotation</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">feginClient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8f5902;font-style:italic">// 获取feginClient注解的值
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000">String</span> <span style="color:#000">applicationName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">annotation1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">value</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">String</span> <span style="color:#000">url</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;http://&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">applicationName</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">path</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8f5902;font-style:italic">// 发送远程调用(ribbon使用),不需要端口
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000">String</span> <span style="color:#000">forObject</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">restTemplate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForObject</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">url</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">forObject</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ce5c00;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">String</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">o</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">doOrder</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">s</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="fegin开发重点">fegin开发重点</h5>
<blockquote>
<p>消费者 和 提供者 的参数列表 一致(传参数) 返回值、方法签名一致</p>
<ol>
<li>URL传参数(<code>testUrl/{name}/add/{age}</code>)，GET请求 参数列表使用 @PathVariable(&quot;&quot;)</li>
<li>GET请求(<code>?value=</code>)，每个基本参数必须加 @RequestParam(&quot;&quot;)</li>
<li>POST请求，传对象、集合等参数，必须加@Requestbody <code>请求体</code>或 @RequestParam <code>表单</code></li>
</ol>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@Data</span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@AllArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@NoArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@Builder</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Order</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">private</span> <span style="color:#000">Integer</span> <span style="color:#000">id</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">private</span> <span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">private</span> <span style="color:#000">Double</span> <span style="color:#000">price</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">private</span> <span style="color:#000">Date</span> <span style="color:#000">time</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>提供者 不同传参接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"> * URL传参 /doOrder2/麻辣香锅/add/可乐/
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"> * GET传递一个参数
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"> * GET传递多个参数
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"> * POST传递一个对象
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"> * POST传递一个对象+一个基本参数
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"> * POST传递两个对象(封装) https://zhuanlan.zhihu.com/p/102389552
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"> *
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"> * @return
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;testUrl/{name}/add/{age}&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">testUrl</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@PathVariable</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#5c35cc;font-weight:bold">@PathVariable</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;age&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span><span style="color:#000">Integer</span> <span style="color:#000">age</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;:&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">age</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;ok&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;oneParam&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">oneParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">required</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;ok&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;twoParam&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">twoParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">required</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">required</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">Integer</span> <span style="color:#000">age</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">age</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;ok&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@PostMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;oneObject&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">oneObject</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestBody</span> <span style="color:#000">Order</span> <span style="color:#000">order</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">order</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;ok&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@PostMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;oneObjectAndParam&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">oneObjectAndParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestBody</span> <span style="color:#000">Order</span> <span style="color:#000">order</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span> <span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">order</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;ok&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>消费者</p>
<p>使用fegin远程调用</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// User模块调用Order模块的fegin
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// value = &#34;order-service&#34; 服务提供者的应用名称
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#5c35cc;font-weight:bold">@feginClient</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;order-service&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">interface</span> <span style="color:#000">UserOrderfegin</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// 需要调用哪个接口
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     写方法签名：
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     (注解)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     @GetMapping(&#34;doOrder&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     (修饰符 返回值 方法名 方法参数)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     *     public String doOrder();
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;doOrder&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">doOrder</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;testUrl/{name}/add/{age}&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">testUrl</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@PathVariable</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#5c35cc;font-weight:bold">@PathVariable</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;age&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span><span style="color:#000">Integer</span> <span style="color:#000">age</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;oneParam&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">oneParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">required</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;twoParam&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">twoParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">required</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">required</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">Integer</span> <span style="color:#000">age</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@PostMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;oneObject&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">oneObject</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestBody</span> <span style="color:#000">Order</span> <span style="color:#000">order</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@PostMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;oneObjectAndParam&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">oneObjectAndParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestBody</span> <span style="color:#000">Order</span> <span style="color:#000">order</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span> <span style="color:#000">String</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 测试接口
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;testParam&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">testParam</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">zq</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">userOrderfegin</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">testUrl</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;zq&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">zq</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">oneParam</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">userOrderfegin</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">oneParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;zq1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">oneParam</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">twoParam</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">userOrderfegin</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">twoParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;zq2&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">twoParam</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Order</span> <span style="color:#000">order</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Order</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">builder</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">name</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;麻辣香锅&#34;</span><span style="color:#ce5c00;font-weight:bold">).</span><span style="color:#c4a000">price</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">188</span><span style="color:#000">D</span><span style="color:#ce5c00;font-weight:bold">).</span><span style="color:#c4a000">time</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Date</span><span style="color:#ce5c00;font-weight:bold">()).</span><span style="color:#c4a000">id</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">).</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">userOrderfegin</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">oneObject</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">order</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">s</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">oneObjectAndParam</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">userOrderfegin</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">oneObjectAndParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">order</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;zq&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">oneObjectAndParam</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;OK&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>时间传参问题</p>
<p>消费者测试接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>   <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 1.单独传送时间参数，会差10个小时
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 2.转成字符串即可 或
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 3.使用jdk的时间类型 LocalDate(年月日) LocalDateTime(时分秒)会丢失秒s
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 4.改fegin的源码
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;time&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">time</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Date</span> <span style="color:#000">date</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Date</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// 年月日
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">LocalDate</span> <span style="color:#000">now</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">LocalDate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">now</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// 时分秒
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">LocalDateTime</span> <span style="color:#000">dateTime</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">LocalDateTime</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">now</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Thu Jul 27 12:48:32 CST 2023
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">String</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">userOrderfegin</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">testTime</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Fri Jul 28 02:48:32 CST 2023
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">s</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p><code>fegin/UserOrderfegin</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;testTime&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">testTime</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span> <span style="color:#000">Date</span> <span style="color:#000">date</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p><code>OrderController.java </code>提供者接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 传时间
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;testTime&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">testTime</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#5c35cc;font-weight:bold">@RequestParam</span> <span style="color:#000">Date</span> <span style="color:#000">date</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;ok&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="fegin调用状态码">fegin调用状态码</h5>
<blockquote>
<p>fegin包的Client接口108行</p>
<p><code>HttpStatus.java</code>(所有状态码)</p>
</blockquote>
<p>200 成功</p>
<p>400 请求参数错误</p>
<p>401 没有权限</p>
<p>403 权限不够</p>
<p>404 路径不匹配</p>
<p>405 方法不允许</p>
<p>500 提供者报错了</p>
<p>302 资源重定向</p>
<h5 id="fegin日志">fegin日志</h5>
<blockquote>
<p>Level(日志等级)</p>
<p>接口请求时间500毫秒/300毫秒 合理</p>
<pre tabindex="0"><code>public static enum Level {
        NONE,
        BASIC,
        HEADERS,
        FULL;

        private Level() {
        }
    }
</code></pre></blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span> <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * feign
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 打印日志信息 级别
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">Logger</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Level</span> <span style="color:#000">level</span><span style="color:#ce5c00;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">Logger</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Level</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">BASIC</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">logging</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">level</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">com.zq.userservice.feign.UserOrderFeign</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">debug</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># 打印这个接口下面的日志</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h4 id="熔断器hystrix">熔断器(Hystrix)</h4>
<blockquote>
<p><strong>服务雪崩</strong></p>
<p>核心本质：线程没有及时回收</p>
<p>熔断：直接return，业务不能完成，但是可以缓解服务器压力</p>
<p>解决方案：</p>
<ol>
<li>调整等待时间，可缓解解压，有局限性(有的服务需要多的时间去执行)</li>
<li>在上游服务知道下游服务的状态，下游服务OK，正常发请求；宕机，则直接return，不发请求。</li>
<li>设置备选方案</li>
</ol>
<p>链式调用：A服务——》B服务——》C服务(挂了)</p>
<ol>
<li>用户请求A服务，A服务tomcat分配一个线程支持用户的访问。A服务发现需要完成用户的操作，需要调用B服务</li>
<li>A服务请求B服务，B服务tomcat分配一个线程支持A服务的访问，B服务发现需要完成用户的操作，需要调用C服务</li>
<li>B服务调用C服务，C服务宕机了，B并不知道。导致A和B的线程没有回收，此时大量请求进入A服务或者B服务，AB会报503 service unavailable</li>
</ol>
</blockquote>
<p>在分布式的链路中，只要有一个服务宕机，可能导致整个业务线都瘫痪。</p>
<blockquote>
<p>Hystrix(Netflx)</p>
<p><strong>用来保护微服务不雪崩的方法</strong>。</p>
<p><strong>能够阻止分布式系统中出现联动故障.</strong></p>
<p>通过隔离服务的访问点阻止联动故障，并提供了故障的解决方案，从而提高整个分布式系统的弹性。</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">server</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8080</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">spring</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">application</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">customer-service</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">eureka</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">client</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">service-url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">defaultZone</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://localhost:8761/eureka</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">instance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">hostname</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">localhost</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">instance-id</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${eureka.instance.hostname}:${spring.application.name}:${server.port}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">feign</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hystrix</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#8f5902;font-style:italic"># 在F版以上默认开启</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#  circuitbreaker:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#    enabled: true   # cloud2020以上的配置</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h4 id="customer-service-消费者"><code>customer-service </code>消费者</h4>
<p><code>pom.xml</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-client<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-cloud-starter-openfeign<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-hystrix<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p><code>feign/CustomerRentFeign.java</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 指定熔断的类，fallback = 失败回调的类
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#5c35cc;font-weight:bold">@FeignClient</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;rent-car-service&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#000">fallback</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">CustomerRentFeignHystrix</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">interface</span> <span style="color:#000">CustomerRentFeign</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@GetMapping</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;rent&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">rent</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p><code>feign/hystrix/CustomerRentFeignHystrix.java</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@Component</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">CustomerRentFeignHystrix</span> <span style="color:#204a87;font-weight:bold">implements</span> <span style="color:#000">CustomerRentFeign</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * 备选方案
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5c35cc;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">public</span> <span style="color:#000">String</span> <span style="color:#000">rent</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;备选方案&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="rent-car-service提供者"><code>rent-car-service</code>提供者</h4>
<p><code>pom.xml</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-client<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id="断路器状态机制">断路器状态机制</h4>
<blockquote>
<p>关：默认情况下关闭，正常调用服务</p>
<p>开：尝试调用服务，在一个时间窗口(10s)内，多次访问，失败次数达到一个阈值，认为拓机了，启动备选方案</p>
<p>半开：让少许流量去尝试调用，如果正常了，就关掉断路器</p>
<p>关——》开——》半开——》关</p>
</blockquote>
<p><code>hystrix/spare</code>手写断路器代码</p>
<h3 id="spring-cloud实现方案">Spring Cloud实现方案</h3>
<blockquote>
<p>SpringCloud 就是微服务理念的一种<strong>具体落地实现方式</strong></p>
</blockquote>
<p>Dubbo+Zookeeper 半自动化的微服务实现架构</p>
<p>SpringCloud Netflix 一站式微服务架构</p>
<p>SpringCloud Alibaba 新的一站式微服务架构</p>

	<ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5">
  <li>
    <a href="/blog/1/01/01/docker/" aria-label="上一页 - Docker" class="btn btn-primary"><span class="me-1">←</span>上一页</a>
  </li>
  <li>
    <a class="btn btn-primary disabled">下一页<span class="ms-1">→</span></a>
  </li>
</ul>

</div>


          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="User mailing list" aria-label="User mailing list">
    <a target="_blank" rel="noopener" href="https://example.org/mail" aria-label="User mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://example.org/twitter" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Stack Overflow" aria-label="Stack Overflow">
    <a target="_blank" rel="noopener" href="https://example.org/stack" aria-label="Stack Overflow">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-end text-xs-center order-sm-3">
        
        
        
<ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/x-windy/" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Slack" aria-label="Slack">
    <a target="_blank" rel="noopener" href="https://example.org/slack" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Developer mailing list" aria-label="Developer mailing list">
    <a target="_blank" rel="noopener" href="https://example.org/mail" aria-label="Developer mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="td-footer__copyright-etc col-12 col-sm-4 text-center py-2 order-sm-2">
        <span>&copy; 2023 XW All Rights Reserved</span>
        
        
      </div>
    </div>
  </div>
  
<link rel="stylesheet" href='/shortcodes/plugins-live2d/css/index.css?v=1.0.1' />
<link rel="stylesheet" href='/shortcodes/plugins-live2d/css/waifu.min.css?v=1.0.1' />

<div class= "plugins-live2d-data" data-live2d_width="200" data-live2d_height="220" data-live2d_position="right:10" data-live2d_minwidth="400px"></div>

<script src='/shortcodes/plugins-live2d/js/index.js?v=1.0.1'></script>

</footer>
    </div>
    
  <script src="/js/main.min.9d4be27dd7b0e6c9b2948920085964b72679202e8e0439382ea6a68173e03576.js" integrity="sha256-nUvifdew5smylIkgCFlktyZ5IC6OBDk4LqamgXPgNXY=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>